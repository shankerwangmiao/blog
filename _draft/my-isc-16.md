---
title: 我的 ISC'16 ：一个好消息，两个坏消息
date: 2016-07-23 19:41:57
tags: 
- SCC
- 感想
---

从德国法兰克福回来之后，一直打算写一篇博客，来纪念一下这次的比赛。后来因为拖延症的原因，迟迟没有写。今天刚好在机场，闲来无事，就顺手把博客写了吧，至少比刷新闻要有意义得多。

## 缘起

在我的上一篇[博客](../we-lost-asc-16)中，我曾经提到我们最终与 ISC'16 失之交臂。然而这个世界就是由无数的巧合和变化构成，所以说，有的时候，我们得学会“拥抱改变”。在我完成那篇博客之后不到一周，我就收到了前任队长捷中转给我的，来自 Pak 的邮件，说是因为有一个队伍因为时间原因退赛了，询问我们是否有意愿参加。这简直是想啥来啥，收到邮件的时候，我着实激动了好一阵。但是激动过后，留给我的是很多疑问：还能召集到一批强有力的队员吗？我们该找谁赞助机器呢？还有时间准备所有的机器吗？还有时间优化应用吗？

## 备战

队伍的人选很快确定了下来。这次比赛，我们一共凑足了 7 个人，再加上恺威强势加盟，人明显比题目多。人员分工上，我还是负责机器和系统，家昌接手了前任队长捷中的 Wrf，冠宇去搞他喜欢的 GPU 程序，其余一干人马则是跑去从头写 Graph 500 。

从接到参赛的通知，到比赛开始，只有短短的一个半月的时间。在这一个半月里，要完成所有应用的测试和优化，还要从头写一个 Graph 500，除此之外，还要找到一个靠谱的赞助商，搞到机器和设备，并且运到德国去。而后边的这个任务，显然是我不能独自完成的。往年都有浪潮替我们包办了一切，现在就得自己动手了。在陈老师和翟老师的联系下，之前表示要赞助我们的比特大陆公司决定继续赞助我们参赛，而且预算十分充足。这让我着实放下心来，因为最大的问题——钱，已经被解决了。然而钱是不能用来运算的，要想参加比赛，还是得变成机器。既然钱不是问题了，那么机器的选型就自由了很多。浪潮的服务器是显然不能用了，在与翟老师简单沟通后，我们一致认为，还是用戴尔的服务器比较靠谱。至于硬件配置，陈老师从 Intel 那里借来了 16 片 2699 v4。与 v3 相比，v4 在 TDP 不变的情况下，多了 4 个物理核心，在比功耗的性能上显然有大幅长进。而加速卡则初步确定是 K80。至于 InfiniBand 和 硬盘则与之前一致，不在话下。

按照以往惯例，由于机器运输时间比较长，我们往往会在家里留一套集群用来训练，比赛的时候则作为测试用途使用。这样，总共就需要 16 台机器。而我们 2699 v4 只够 8 台机器使用，而且国内没有额外的货源，所以往年的来回换 CPU 的事情仍然在继续。更加棘手的，则是内存的问题，这两种 CPU 所需要搭配的内存型号不一样：v4 需要 2400M 的内存条，而 v3 需要配 2133M 的内存条，这意味着，我们不但要更换 CPU，还要多买一套内存条，这就很麻烦了。后来经过与工程师的沟通，我们获知，2400M 的内存条是与 v3 的 CPU 兼容的，使用时会自动降到 2133M 的工作模式。知道了这一点之后，我长出一口气：省了不少麻烦。

既然选用了 DELL 的服务器，就要一坑到底。在官网的配置界面，我注意到 DELL 对于我们这种愿意折腾机器的需求，特地配上了一个神器——线缆整理臂。这是一个可折叠的线槽，把线缆放在里面，机器上架时，线槽折叠在机器后面；在抽出机器的时候，线槽随之展开，免去了抽出机器是后边牵着线缆的痛苦。

最终，我和比特大陆的工程师确定了一套奇葩的配置单。

```
# 八台服务器，运往德国：

- Chassis with up to 8, 2.5" Hard Drives，标准机箱
- no CPU，无CPU
- 2x CPU 散热器
- 8x 16G Samsung DDR4 2400MT/s，内存
- iDRAC8 Enterprise，iDrac8 企业版
- Embedded SATA，内置SATA控制器
- no PERC H330，no PERC H330 控制器
- no SSD, no SSD
- No Internal Optical Drive，无光驱
- Standard Bezel ，标配前面板
- ReadyRails™ Sliding Rails With Cable Management Arm (ReadyRails™ 滑动导轨, 带电缆管理臂)
- 2x  Hot-plug, Redundant Power Supply (1+1), 1100W，1100W 冗余电源 
- 2x C13 to C14, PDU Style, 12 AMP, 6.5 Feet (2m) Power Cord, North America，2米美标电源线
- Risers with up to 1, x8 PCIe Slots + 2, x16 PCIe Slots (RISER卡, 最多可配4个x8 PCIe插槽 + 2个x16 PCIe插槽)
- R730 GPU 安装套件 for Tesla K80

# 八台服务器，运往清华

- Chassis with up to 8, 2.5" Hard Drives，标准机箱
- 2x 2699v3 CPU，CPU
- 2x CPU 散热器
- 8x 16G Samsung DDR4 2400MT/s，内存
- iDRAC8 Enterprise，iDrac8 企业版
- Embedded SATA，内置SATA控制器
- no PERC H330，no PERC H330 控制器
- no SSD, no SSD
- No Internal Optical Drive，无光驱
- Standard Bezel ，标配前面板
- ReadyRails™ Sliding Rails With Cable Management Arm (ReadyRails™ 滑动导轨, 带电缆管理臂)
- 2x  Hot-plug, Redundant Power Supply (1+1), 1100W，1100W 冗余电源 
- 2x C13 to C14, PDU Style, 12 AMP, 6.5 Feet (2m) Power Cord, North America，2米美标电源线
- Risers with up to 1, x8 PCIe Slots + 2, x16 PCIe Slots (RISER卡, 最多可配4个x8 PCIe插槽 + 2个x16 PCIe插槽)
- R730 GPU 安装套件 for Tesla K80

# 零部件，运往德国

- 1x Dell Netshelter SX 42U 600mm Wide x 1070mm Deep Rack Enclosure， 42U机柜
- 20x 3M AMP cat6 cable for 1Gb Base-T，3米六类网线
- 4x 2m c13 - c14 2米美标电源线
- 1x Dell  17" VGA显示器 – E1715S
- 1x Dell USB 标准键盘
- 8x 16G Samsung DDR4 2400MT/s，增加的内存


```

说起比特大陆的周工，我是要特别感谢的。在最初与比特大陆联系的时候，我先按照我的思路和需要，拟了一份配置单。然而，比特大陆方面对接的人并不是专业于服务器的配置，大概拖了半个月之久，也没有搞定货源的问题，诚惶论这种奇葩的配置需求呢。后来，周工被请来“救火”，不到一周的时间，就和戴尔的经销商取得了有效联系，敲定了配置，还替我考虑了很多问题；除此之外，还动用了私人的渠道紧急配出来这么一批服务器。当我还没反应过来的时候，8 台要运往德国的服务器就这么静静地躺在了比特大陆公司的地上。于是我揣上几片 CPU，又塞装了一块 K80 ，就前往比特大陆公司去测试机器。

等到了公司，我和周工一起